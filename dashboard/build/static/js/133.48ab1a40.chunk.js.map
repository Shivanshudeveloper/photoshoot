{"version":3,"sources":["components/map/MapClusters.js"],"names":["clusterLayer","id","type","source","filter","paint","clusterCountLayer","layout","unclusteredPointLayer","MapClusters","other","mapRef","useRef","useState","latitude","longitude","zoom","bearing","pitch","viewport","setViewport","onViewportChange","interactiveLayerIds","onClick","event","feature","features","clusterId","properties","cluster_id","current","getMap","getSource","getClusterExpansionZoom","err","geometry","coordinates","isNaN","transitionDuration","ref","data","cluster","clusterMaxZoom","clusterRadius"],"mappings":"+OAKMA,EAAe,CACnBC,GAAI,WACJC,KAAM,SACNC,OAAQ,cACRC,OAAQ,CAAC,MAAO,eAChBC,MAAO,CACL,eAAgB,CAAC,OAAQ,CAAC,MAAO,eAAgB,UAAW,IAAK,UAAW,IAAK,WACjF,gBAAiB,CAAC,OAAQ,CAAC,MAAO,eAAgB,GAAI,IAAK,GAAI,IAAK,MAIlEC,EAAoB,CACxBL,GAAI,gBACJC,KAAM,SACNC,OAAQ,cACRC,OAAQ,CAAC,MAAO,eAChBG,OAAQ,CACN,aAAc,4BACd,YAAa,CAAC,sBAAuB,yBACrC,YAAa,KAIXC,EAAwB,CAC5BP,GAAI,oBACJC,KAAM,SACNC,OAAQ,cACRC,OAAQ,CAAC,IAAK,CAAC,MAAO,gBACtBC,MAAO,CACL,eAAgB,UAChB,gBAAiB,EACjB,sBAAuB,EACvB,sBAAuB,SAMZ,SAASI,EAAT,GAAoC,IAAVC,EAAS,oBAC1CC,EAASC,iBAAO,MACtB,EAAgCC,mBAAS,CACvCC,SAAU,MACVC,WAAY,OACZC,KAAM,EACNC,QAAS,EACTC,MAAO,IALT,mBAAOC,EAAP,KAAiBC,EAAjB,KA4BA,OACE,mCACE,cAAC,IAAD,uCACMD,GADN,IAEEE,iBAAkBD,EAClBE,oBAAqB,CAACtB,EAAaC,IACnCsB,QA1BU,SAACC,GACf,IAAMC,EAAUD,EAAME,SAAS,GACzBC,EAAYF,GAAWA,EAAQG,WAAWC,WAC3BlB,EAAOmB,QAAQC,SAASC,UAAU,eAE1CC,wBAAwBN,GAAW,SAACO,EAAKlB,GAChDkB,GAGJd,EAAY,2BACPD,GADM,IAETJ,UAAWU,GAAWA,EAAQU,SAASC,YAAY,GACnDtB,SAAUW,GAAWA,EAAQU,SAASC,YAAY,GAElDpB,KAAMqB,MAAMrB,GAAQ,EAAIA,EACxBsB,mBAAoB,WAYpBC,IAAK5B,GACDD,GANN,aAQE,eAAC,IAAD,CACET,GAAG,cACHC,KAAK,UACLsC,KAAK,kEACLC,SAAO,EACPC,eAAgB,GAChBC,cAAe,GANjB,UAQE,cAAC,IAAD,eAAW3C,IACX,cAAC,IAAD,eAAWM,IACX,cAAC,IAAD,eAAWE","file":"static/js/133.48ab1a40.chunk.js","sourcesContent":["import { useState, useRef } from 'react';\nimport MapGL, { Source, Layer } from 'react-map-gl';\n\n// ----------------------------------------------------------------------\n\nconst clusterLayer = {\n  id: 'clusters',\n  type: 'circle',\n  source: 'earthquakes',\n  filter: ['has', 'point_count'],\n  paint: {\n    'circle-color': ['step', ['get', 'point_count'], '#51bbd6', 100, '#f1f075', 750, '#f28cb1'],\n    'circle-radius': ['step', ['get', 'point_count'], 20, 100, 30, 750, 40]\n  }\n};\n\nconst clusterCountLayer = {\n  id: 'cluster-count',\n  type: 'symbol',\n  source: 'earthquakes',\n  filter: ['has', 'point_count'],\n  layout: {\n    'text-field': '{point_count_abbreviated}',\n    'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],\n    'text-size': 12\n  }\n};\n\nconst unclusteredPointLayer = {\n  id: 'unclustered-point',\n  type: 'circle',\n  source: 'earthquakes',\n  filter: ['!', ['has', 'point_count']],\n  paint: {\n    'circle-color': '#11b4da',\n    'circle-radius': 4,\n    'circle-stroke-width': 1,\n    'circle-stroke-color': '#fff'\n  }\n};\n\n// ----------------------------------------------------------------------\n\nexport default function MapClusters({ ...other }) {\n  const mapRef = useRef(null);\n  const [viewport, setViewport] = useState({\n    latitude: 40.67,\n    longitude: -103.59,\n    zoom: 3,\n    bearing: 0,\n    pitch: 0\n  });\n\n  const onClick = (event) => {\n    const feature = event.features[0];\n    const clusterId = feature && feature.properties.cluster_id;\n    const mapboxSource = mapRef.current.getMap().getSource('earthquakes');\n\n    mapboxSource.getClusterExpansionZoom(clusterId, (err, zoom) => {\n      if (err) {\n        return;\n      }\n      setViewport({\n        ...viewport,\n        longitude: feature && feature.geometry.coordinates[0],\n        latitude: feature && feature.geometry.coordinates[1],\n        // eslint-disable-next-line no-restricted-globals\n        zoom: isNaN(zoom) ? 3 : zoom,\n        transitionDuration: 500\n      });\n    });\n  };\n\n  return (\n    <>\n      <MapGL\n        {...viewport}\n        onViewportChange={setViewport}\n        interactiveLayerIds={[clusterLayer.id]}\n        onClick={onClick}\n        ref={mapRef}\n        {...other}\n      >\n        <Source\n          id=\"earthquakes\"\n          type=\"geojson\"\n          data=\"https://docs.mapbox.com/mapbox-gl-js/assets/earthquakes.geojson\"\n          cluster\n          clusterMaxZoom={14}\n          clusterRadius={50}\n        >\n          <Layer {...clusterLayer} />\n          <Layer {...clusterCountLayer} />\n          <Layer {...unclusteredPointLayer} />\n        </Source>\n      </MapGL>\n    </>\n  );\n}\n"],"sourceRoot":""}